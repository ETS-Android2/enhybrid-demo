#import <Cordova/CDVPluginResult.h>
#import "SwitchLanguagePlugin.h"
#import "DAConfig.h"
#import "AppDelegate.h"

@implementation SwitchLanguagePlugin
- (void)switchLanguage:(CDVInvokedUrlCommand*)command {
    NSString *language = [command argumentAtIndex:0];
    if ([language containsString: @"en"]) {
        [DAConfig setUserLanguage: CONFIG_LANGUAGE_EN];
    }else{
        [DAConfig setUserLanguage: CONFIG_LANGUAGE_ZH];
    }
    CDVPluginResult* pluginResult = [CDVPluginResult resultWithStatus:CDVCommandStatus_OK];
    AppDelegate *delegate = [[UIApplication sharedApplication] delegate];
    [[NSNotificationCenter defaultCenter] postNotificationName:@"LanguageChanged" object:nil];
    [delegate exitApplication];
    [self.commandDelegate sendPluginResult:pluginResult callbackId:command.callbackId];
}
@end
